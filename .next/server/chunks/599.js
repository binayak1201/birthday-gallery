"use strict";exports.id=599,exports.ids=[599],exports.modules={10:(n,o,e)=>{e.d(o,{v:()=>connectToDatabase});var t=e(1185),c=e.n(t);let r=process.env.MONGODB_URI;if(!r)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose||{conn:null,promise:null};async function connectToDatabase(){try{if(i.conn){if(1===c().connection.readyState)return i.conn;await c().connection.close(),i.conn=null,i.promise=null}return i.promise||(i.promise=c().connect(r,{bufferCommands:!1,maxPoolSize:10,minPoolSize:5,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,family:4,retryWrites:!0,retryReads:!0,writeConcern:{w:"majority",wtimeout:2500},autoCreate:!0,autoIndex:!0,connectTimeoutMS:1e4}).then(n=>(n.connection.on("error",n=>{i&&(i.conn=null,i.promise=null)}),n.connection.on("disconnected",()=>{i&&(i.conn=null,i.promise=null)}),n.connection.on("connected",()=>{}),n))),i.conn=await i.promise,i.conn}catch(n){throw i.conn=null,i.promise=null,n}}global.mongoose||(global.mongoose=i)}};