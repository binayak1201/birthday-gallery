"use strict";(()=>{var e={};e.id=655,e.ids=[655],e.modules={1185:e=>{e.exports=require("mongoose")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2382:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>_,originalPathname:()=>y,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>w});var a={};r.r(a),r.d(a,{GET:()=>GET,POST:()=>POST}),r(8976);var o=r(884),i=r(6132),s=r(5798),n=r(5599),u=r(9584);async function POST(e){try{await (0,n.v)();let t=await e.json(),{title:r,description:a,date:o,photoIds:i}=t;if(!r||!i?.length)return s.Z.json({error:"Title and photos are required"},{status:400});let p=await u.o.create({title:r,description:a,date:o});return await u.P.updateMany({public_id:{$in:i}},{story:p._id}),s.Z.json(p)}catch(e){return s.Z.json({error:"Error creating story"},{status:500})}}async function GET(){try{await (0,n.v)();let e=await u.o.find().sort({date:-1}),t=await Promise.all(e.map(async e=>{let t=await u.P.find({story:e._id});return{...e.toObject(),photos:t}}));return s.Z.json(t)}catch(e){return s.Z.json({error:"Error fetching stories"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/stories/route",pathname:"/api/stories",filename:"route",bundlePath:"app/api/stories/route"},resolvedPagePath:"C:\\bday\\app\\api\\stories\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:l,headerHooks:_,staticGenerationBailout:w}=p,y="/api/stories/route"}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[955,599,584],()=>__webpack_exec__(2382));module.exports=r})();